<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    <title>3.6. 多表操作 &#8212; Python 数据科学实战 1.0.0 documentation</title>

    <link rel="stylesheet" href="../_static/material-design-lite-1.3.0/material.blue-deep_orange.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx_materialdesign_theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/fontawesome/all.css" type="text/css" />
    <link rel="stylesheet" href="../_static/fonts.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/d2l.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/d2l.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. 参考文献" href="../refs.html" />
    <link rel="prev" title="3.5. 分组汇总" href="dataframe-groupby.html" /> 
  </head>
<body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-drawer"><header class="mdl-layout__header mdl-layout__header--waterfall ">
    <div class="mdl-layout__header-row">
        
        <nav class="mdl-navigation breadcrumb">
            <a class="mdl-navigation__link" href="index.html"><span class="section-number">3. </span>pandas</a><i class="material-icons">navigate_next</i>
            <a class="mdl-navigation__link is-active"><span class="section-number">3.6. </span>多表操作</a>
        </nav>
        <div class="mdl-layout-spacer"></div>
        <nav class="mdl-navigation">
        
<form class="form-inline pull-sm-right" action="../search.html" method="get">
      <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right">
        <label id="quick-search-icon" class="mdl-button mdl-js-button mdl-button--icon"  for="waterfall-exp">
          <i class="material-icons">search</i>
        </label>
        <div class="mdl-textfield__expandable-holder">
          <input class="mdl-textfield__input" type="text" name="q"  id="waterfall-exp" placeholder="Search" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </div>
      </div>
      <div class="mdl-tooltip" data-mdl-for="quick-search-icon">
      Quick search
      </div>
</form>
        
<a id="button-show-source"
    class="mdl-button mdl-js-button mdl-button--icon"
    href="../_sources/ch-pandas/dataframe-merge-concat.rst.txt" rel="nofollow">
  <i class="material-icons">code</i>
</a>
<div class="mdl-tooltip" data-mdl-for="button-show-source">
Show Source
</div>
        </nav>
    </div>
    <div class="mdl-layout__header-row header-links">
      <div class="mdl-layout-spacer"></div>
      <nav class="mdl-navigation">
          
              <a  class="mdl-navigation__link" href="https://github.com/py-101/python-data-science">
                  <i class="fab fa-github"></i>
                  GitHub
              </a>
      </nav>
    </div>
</header><header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="../index.html">
              <span class="title-text">
                  Python 数据科学实战
              </span>
          </a>
      </span>
    
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ch-python-lang/index.html">1. Python 编程语言</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch-python-lang/outline.html">1.1. 本书主要内容</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ch-numpy/index.html">2. NumPy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch-numpy/numpy-intro.html">2.1. NumPy 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch-numpy/ndarray.html">2.2. ndarray</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">3. pandas</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pandas-intro.html">3.1. pandas 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="series-dataframe.html">3.2. Series 与 DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataframe-slicing.html">3.3. 数据切片</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-preprocessing.html">3.4. 数据处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataframe-groupby.html">3.5. 分组汇总</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.6. 多表操作</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">4. 参考文献</a></li>
</ul>

            </nav>
        
        </div>
    
</header>
        <main class="mdl-layout__content" tabIndex="0">

	<script type="text/javascript" src="../_static/sphinx_materialdesign_theme.js "></script>
    <header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="../index.html">
              <span class="title-text">
                  Python 数据科学实战
              </span>
          </a>
      </span>
    
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ch-python-lang/index.html">1. Python 编程语言</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch-python-lang/outline.html">1.1. 本书主要内容</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ch-numpy/index.html">2. NumPy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch-numpy/numpy-intro.html">2.1. NumPy 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch-numpy/ndarray.html">2.2. ndarray</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">3. pandas</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pandas-intro.html">3.1. pandas 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="series-dataframe.html">3.2. Series 与 DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataframe-slicing.html">3.3. 数据切片</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-preprocessing.html">3.4. 数据处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataframe-groupby.html">3.5. 分组汇总</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.6. 多表操作</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">4. 参考文献</a></li>
</ul>

            </nav>
        
        </div>
    
</header>

    <div class="document">
        <div class="page-content" role="main">
        
  <div class="section" id="dataframe-merge-concat">
<span id="id1"></span><h1><span class="section-number">3.6. </span>多表操作<a class="headerlink" href="#dataframe-merge-concat" title="Permalink to this heading">¶</a></h1>
<p>之前的操作主要在单个 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ，实际上，我们经常需要对多个
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 联合起来进行分析。pandas 提供了多 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
之间的合并和连接的操作，分别是 <code class="docutils literal notranslate"><span class="pre">merge()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">concat()</span></code>
函数。比如，我们可以将两个 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 合并成一个，且保留所有的列。</p>
<div class="section" id="merge">
<h2><span class="section-number">3.6.1. </span>merge<a class="headerlink" href="#merge" title="Permalink to this heading">¶</a></h2>
<p>pandas 的 <code class="docutils literal notranslate"><span class="pre">merge</span></code> 操作可以合并两个 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>（或者称为表）
，类似于 SQL 中的 JOIN 操作。
我们可以想象成：一个大表被拆分成两个小表，两个小表都包含一些同样的数据。现在我们需要把两个小表合并，生成一个大表，大表包含了两个小表的字段。</p>
<div class="figure align-default" id="id5">
<span id="merge-img"></span><a class="reference internal image-reference" href="../_images/merge.svg"><img alt="../_images/merge.svg" src="../_images/merge.svg" width="800px" /></a>
<p class="caption"><span class="caption-number">图3.6.1 </span><span class="caption-text">分组与汇总</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># customer_prod_df</span>
<span class="n">d1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;customer_id&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]),</span>
  <span class="s1">&#39;product&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;Oven&#39;</span><span class="p">,</span><span class="s1">&#39;Oven&#39;</span><span class="p">,</span><span class="s1">&#39;Oven&#39;</span><span class="p">,</span><span class="s1">&#39;Television&#39;</span><span class="p">,</span><span class="s1">&#39;Television&#39;</span><span class="p">,</span><span class="s1">&#39;Television&#39;</span><span class="p">])}</span>
<span class="n">customer_prod_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;customer_prod_df:&quot;</span><span class="p">)</span>
<span class="n">customer_prod_df</span>
</pre></div>
</div>
<div class="output highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">customer_prod_df</span><span class="p">:</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_id</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Oven</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Oven</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Oven</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Television</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Television</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>Television</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># customer_state_df</span>
<span class="n">d2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;customer_id&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]),</span>
    <span class="s1">&#39;state&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;California&#39;</span><span class="p">,</span><span class="s1">&#39;California&#39;</span><span class="p">,</span><span class="s1">&#39;Texas&#39;</span><span class="p">,</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span><span class="s1">&#39;Indiana&#39;</span><span class="p">])}</span>
<span class="n">customer_state_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;customer_state_df:&quot;</span><span class="p">)</span>
<span class="n">customer_state_df</span>
</pre></div>
</div>
<div class="output highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">customer_state_df</span><span class="p">:</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_id</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>California</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>California</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>Texas</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>New York</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>Indiana</td>
    </tr>
  </tbody>
</table>
</div><p>我们先用下面的代码得到合并的结果，所使用的各类参数后面详细探讨。</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_join_df</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">customer_prod_df</span><span class="p">,</span> <span class="n">customer_state_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">inner_join_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_id</th>
      <th>product</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Oven</td>
      <td>California</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>Television</td>
      <td>California</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>Television</td>
      <td>Texas</td>
    </tr>
  </tbody>
</table>
</div><p>合并两个表时，通常需要使用键（key）来判断哪些数据与哪些数据合并。比如本例中，两个表都包含
<code class="docutils literal notranslate"><span class="pre">customer_id</span></code> 这个字段，<code class="docutils literal notranslate"><span class="pre">customer_id</span></code> 可以被用来连接这两个
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>。相同 <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> 的行被合并在一起。</p>
<p>我们回到 <code class="docutils literal notranslate"><span class="pre">merge</span></code>
函数的参数。完整的参数形式为：<code class="docutils literal notranslate"><span class="pre">pd.merge(left,</span> <span class="pre">right,</span> <span class="pre">how='inner',</span> <span class="pre">on=None,</span> <span class="pre">left_on=None,</span> <span class="pre">right_on=None,</span> <span class="pre">left_index=False,</span> <span class="pre">right_index=False,</span> <span class="pre">sort=False,suffixes=('_x','_y'))</span></code>。虽然参数很多，其实大部分时间我们主要关心的是
<code class="docutils literal notranslate"><span class="pre">left</span></code>、<code class="docutils literal notranslate"><span class="pre">right</span></code>、<code class="docutils literal notranslate"><span class="pre">how</span></code> 和 <code class="docutils literal notranslate"><span class="pre">on</span></code>。</p>
<p><code class="docutils literal notranslate"><span class="pre">left</span></code> 与 <code class="docutils literal notranslate"><span class="pre">right</span></code> 是两个 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>，分别为左侧表和右侧表。</p>
<p><code class="docutils literal notranslate"><span class="pre">on</span></code>
表示两个表依据哪个字段（或哪些字段）进行合并。这个字段或这些字段被称为键（key）。两个表的
key 字段应该是表示同一个事物。现在我们要根据 key，把两个 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
合并成一个更大的表。这个例子中，以 <code class="docutils literal notranslate"><span class="pre">customer_id</span></code>
为字段进行合并，主要对左右两个表中相同 <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> 进行操作。</p>
<p><code class="docutils literal notranslate"><span class="pre">how</span></code> 表示合并的方式。在合并过程中，左侧表和右侧表的 key
不一定都包含同样的值。比如，如果左侧表包含某个 <code class="docutils literal notranslate"><span class="pre">customer_id</span></code>
但右侧表不包含这个
<code class="docutils literal notranslate"><span class="pre">customer_id</span></code>，那应该遵循什么样的逻辑去合并。<code class="docutils literal notranslate"><span class="pre">how='inner'</span></code>
是其中一种方式，叫做内连接：只有在左侧 DataFrame 和右侧 DataFrame 中
** 都 ** 存在的行才会包含在结果中。</p>
<p><code class="docutils literal notranslate"><span class="pre">how</span></code> 除了 <code class="docutils literal notranslate"><span class="pre">inner</span></code>，还有其他的选项：<code class="docutils literal notranslate"><span class="pre">outer</span></code>、<code class="docutils literal notranslate"><span class="pre">left</span></code> 和
<code class="docutils literal notranslate"><span class="pre">right</span></code>。</p>
<div class="figure align-default" id="id6">
<span id="merge-how"></span><a class="reference internal image-reference" href="../_images/merge-how.svg"><img alt="../_images/merge-how.svg" src="../_images/merge-how.svg" width="800px" /></a>
<p class="caption"><span class="caption-number">图3.6.2 </span><span class="caption-text">合并方式</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id2">
<h3><span class="section-number">3.6.1.1. </span>连接方式<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>外连接</p></li>
</ul>
<p>外连接把左右两侧所有的数据都合并到一起，如果某个表有缺失值，无法左右对齐，则填充
<code class="docutils literal notranslate"><span class="pre">NaN</span></code>。</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outer_join_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">customer_prod_df</span><span class="p">,</span> <span class="n">customer_state_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">outer_join_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_id</th>
      <th>product</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Oven</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Oven</td>
      <td>California</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Oven</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Television</td>
      <td>California</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Television</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>Television</td>
      <td>Texas</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>NaN</td>
      <td>New York</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>NaN</td>
      <td>Indiana</td>
    </tr>
  </tbody>
</table>
</div><ul class="simple">
<li><p>左连接</p></li>
</ul>
<p>左侧表的数据都被保留，如果右侧表有缺失，填充 <code class="docutils literal notranslate"><span class="pre">NaN</span></code>。</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">left_join_df</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">customer_prod_df</span><span class="p">,</span> <span class="n">customer_state_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">left_join_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_id</th>
      <th>product</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Oven</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Oven</td>
      <td>California</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Oven</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Television</td>
      <td>California</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Television</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>Television</td>
      <td>Texas</td>
    </tr>
  </tbody>
</table>
</div><ul class="simple">
<li><p>右连接</p></li>
</ul>
<p>右侧表的数据都被保留，如果左侧表有缺失，填充 <code class="docutils literal notranslate"><span class="pre">NaN</span></code>。</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">right_join_df</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">customer_prod_df</span><span class="p">,</span> <span class="n">customer_state_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">right_join_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_id</th>
      <th>product</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Oven</td>
      <td>California</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>Television</td>
      <td>California</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>Television</td>
      <td>Texas</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>NaN</td>
      <td>New York</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>NaN</td>
      <td>Indiana</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="id3">
<h3><span class="section-number">3.6.1.2. </span>其他合并方式<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>还有一些其他合并，不是根据 key 去在左右表中查找。比如，根据
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 最左侧的 index 列。<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 默认有 index
列，根据该列合并两个表，由于此时不是根据 <code class="docutils literal notranslate"><span class="pre">customer_id</span></code>
来合并，合并之后保留了两个 <code class="docutils literal notranslate"><span class="pre">customer_id</span></code>，为了区别左右两表的
<code class="docutils literal notranslate"><span class="pre">customer_id</span></code>，这里加了后缀 <code class="docutils literal notranslate"><span class="pre">_x</span></code> 和 <code class="docutils literal notranslate"><span class="pre">_y</span></code>。</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">customer_prod_df</span><span class="p">,</span> <span class="n">customer_state_df</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">index_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_id_x</th>
      <th>product</th>
      <th>customer_id_y</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Oven</td>
      <td>2</td>
      <td>California</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Oven</td>
      <td>4</td>
      <td>California</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Oven</td>
      <td>6</td>
      <td>Texas</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Television</td>
      <td>7</td>
      <td>New York</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Television</td>
      <td>8</td>
      <td>Indiana</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="concat">
<h2><span class="section-number">3.6.2. </span>concat<a class="headerlink" href="#concat" title="Permalink to this heading">¶</a></h2>
<p>与 <code class="docutils literal notranslate"><span class="pre">merge</span></code> 对表结构进行横向的操作不同，<code class="docutils literal notranslate"><span class="pre">concat</span></code>
函数默认是进行纵向的合并，也就是将多行进行 ** 堆叠式 ** 的合并。</p>
<p>比如下面的例子，把所有的行和所有的列合并在一起，缺失的填充 <code class="docutils literal notranslate"><span class="pre">NaN</span></code>。</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row_concat_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">customer_prod_df</span><span class="p">,</span> <span class="n">customer_state_df</span><span class="p">])</span>
<span class="n">row_concat_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_id</th>
      <th>product</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Oven</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Oven</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Oven</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Television</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Television</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>Television</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>NaN</td>
      <td>California</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>NaN</td>
      <td>California</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>NaN</td>
      <td>Texas</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>NaN</td>
      <td>New York</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>NaN</td>
      <td>Indiana</td>
    </tr>
  </tbody>
</table>
</div><p>下面的例子，设定了 <code class="docutils literal notranslate"><span class="pre">join=&quot;inner&quot;</span></code>，两个表中都包含 <code class="docutils literal notranslate"><span class="pre">customer_id</span></code>
字段进行了纵向合并。需要注意的是，<code class="docutils literal notranslate"><span class="pre">concat</span></code>
是进行纵向的堆叠，而没有去除重复的 <code class="docutils literal notranslate"><span class="pre">customer_id</span></code>。</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">concat_inner_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">customer_prod_df</span><span class="p">,</span> <span class="n">customer_state_df</span><span class="p">],</span> <span class="n">join</span> <span class="o">=</span> <span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">concat_inner_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="id4">
<h2><span class="section-number">3.6.3. </span>案例：学生成绩<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h2>
<p>我们使用一个学生成绩的案例来演示如何对两个 <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> 进行
<code class="docutils literal notranslate"><span class="pre">merge</span></code>。</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hide outputs</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">folder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;./data/student-score&quot;</span><span class="p">)</span>
<span class="n">score_download_url</span> <span class="o">=</span> <span class="s2">&quot;score.csv&quot;</span>
<span class="n">student_attr_download_url</span> <span class="o">=</span> <span class="s2">&quot;student.csv&quot;</span>

<span class="n">score_file_name</span> <span class="o">=</span> <span class="n">score_download_url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">student_file_name</span> <span class="o">=</span> <span class="n">student_attr_download_url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">score_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="n">score_file_name</span><span class="p">)</span>
<span class="n">student_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="n">student_file_name</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
    <span class="c1"># 创建文件夹</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;文件夹不存在，已创建。&quot;</span><span class="p">)</span>

    <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">score_download_url</span><span class="p">,</span> <span class="n">score_path</span><span class="p">)</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">student_attr_download_url</span><span class="p">,</span> <span class="n">student_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;数据已下载。&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;文件夹已存在，无需操作。&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;student DF:&quot;</span><span class="p">)</span>
<span class="n">student_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">student_path</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shape of this DF: </span><span class="si">{</span><span class="n">student_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the first 2 rows of this DF:&quot;</span><span class="p">)</span>
<span class="n">student_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="output highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">student</span> <span class="n">DF</span><span class="p">:</span>
<span class="n">shape</span> <span class="n">of</span> <span class="n">this</span> <span class="n">DF</span><span class="p">:</span> <span class="p">(</span><span class="mi">44</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">the</span> <span class="n">first</span> <span class="mi">2</span> <span class="n">rows</span> <span class="n">of</span> <span class="n">this</span> <span class="n">DF</span><span class="p">:</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sno</th>
      <th>sname</th>
      <th>sex</th>
      <th>dept</th>
      <th>major</th>
      <th>claasno</th>
      <th>home_address</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019101101</td>
      <td>张元</td>
      <td>男</td>
      <td>信息学院</td>
      <td>计算机</td>
      <td>1</td>
      <td>北京市</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019101102</td>
      <td>李玲</td>
      <td>女</td>
      <td>信息学院</td>
      <td>计算机</td>
      <td>1</td>
      <td>天津市</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;score DF:&quot;</span><span class="p">)</span>
<span class="n">score_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">score_path</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of this DF: </span><span class="si">{</span><span class="n">score_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the first 2 rows of this DF:&quot;</span><span class="p">)</span>
<span class="n">score_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="output highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">score</span> <span class="n">DF</span><span class="p">:</span>
<span class="n">Shape</span> <span class="n">of</span> <span class="n">this</span> <span class="n">DF</span><span class="p">:</span> <span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">the</span> <span class="n">first</span> <span class="mi">2</span> <span class="n">rows</span> <span class="n">of</span> <span class="n">this</span> <span class="n">DF</span><span class="p">:</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sno</th>
      <th>cno</th>
      <th>cname</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019101103</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>78</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019102105</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>97</td>
    </tr>
  </tbody>
</table>
</div><p>可以看到两个表都包含了 <code class="docutils literal notranslate"><span class="pre">sno</span></code>，也就是学号，可以使用学号作为 key
进行合并。</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="n">student_df</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">score_df</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;sno&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shape of this DF: </span><span class="si">{</span><span class="n">merged_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the first 2 rows:&quot;</span><span class="p">)</span>
<span class="n">merged_df</span>
</pre></div>
</div>
<div class="output highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="n">of</span> <span class="n">this</span> <span class="n">DF</span><span class="p">:</span> <span class="p">(</span><span class="mi">44</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">the</span> <span class="n">first</span> <span class="mi">2</span> <span class="n">rows</span><span class="p">:</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sno</th>
      <th>sname</th>
      <th>sex</th>
      <th>dept</th>
      <th>major</th>
      <th>claasno</th>
      <th>home_address</th>
      <th>cno</th>
      <th>cname</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019101101</td>
      <td>张元</td>
      <td>男</td>
      <td>信息学院</td>
      <td>计算机</td>
      <td>1</td>
      <td>北京市</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019101102</td>
      <td>李玲</td>
      <td>女</td>
      <td>信息学院</td>
      <td>计算机</td>
      <td>1</td>
      <td>天津市</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019101103</td>
      <td>张浩</td>
      <td>男</td>
      <td>信息学院</td>
      <td>信息资源管理</td>
      <td>2</td>
      <td>上海市</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019102101</td>
      <td>王雨菲</td>
      <td>女</td>
      <td>财金学院</td>
      <td>财政学</td>
      <td>3</td>
      <td>重庆市</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019102102</td>
      <td>赵靖</td>
      <td>女</td>
      <td>经济学院</td>
      <td>计量经济</td>
      <td>1</td>
      <td>河北石家庄</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019102103</td>
      <td>王明</td>
      <td>女</td>
      <td>经济学院</td>
      <td>计量经济</td>
      <td>2</td>
      <td>山西太原</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2019102104</td>
      <td>李华</td>
      <td>男</td>
      <td>数学学院</td>
      <td>应用数学</td>
      <td>3</td>
      <td>内蒙古呼和浩特</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2019102105</td>
      <td>张伟</td>
      <td>男</td>
      <td>数学学院</td>
      <td>应用数学</td>
      <td>4</td>
      <td>辽宁沈阳</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>97.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2019103101</td>
      <td>赵娟</td>
      <td>女</td>
      <td>信息学院</td>
      <td>大数据</td>
      <td>2</td>
      <td>吉林长春</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2019103102</td>
      <td>刘磊</td>
      <td>男</td>
      <td>统计学院</td>
      <td>统计学</td>
      <td>2</td>
      <td>黑龙江哈尔滨</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2019103103</td>
      <td>陈静</td>
      <td>女</td>
      <td>信息学院</td>
      <td>计算机</td>
      <td>4</td>
      <td>江苏南京</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2019103104</td>
      <td>杨晨</td>
      <td>男</td>
      <td>财金学院</td>
      <td>金融</td>
      <td>3</td>
      <td>浙江杭州</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2019103105</td>
      <td>刘洋</td>
      <td>男</td>
      <td>经济学院</td>
      <td>应用经济</td>
      <td>1</td>
      <td>安徽合肥</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2019103106</td>
      <td>刘婷</td>
      <td>女</td>
      <td>信息学院</td>
      <td>计算机</td>
      <td>2</td>
      <td>福建福州</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2019103107</td>
      <td>李军</td>
      <td>男</td>
      <td>统计学院</td>
      <td>统计学</td>
      <td>2</td>
      <td>江西南昌</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2019103108</td>
      <td>张丽</td>
      <td>女</td>
      <td>信息学院</td>
      <td>大数据</td>
      <td>4</td>
      <td>山东济南</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>98.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2019103109</td>
      <td>王强</td>
      <td>男</td>
      <td>数学学院</td>
      <td>基础数学</td>
      <td>3</td>
      <td>河南郑州</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>92.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2019103110</td>
      <td>李萍</td>
      <td>女</td>
      <td>信息学院</td>
      <td>计算机</td>
      <td>2</td>
      <td>湖北武汉</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2019103111</td>
      <td>赵鑫</td>
      <td>男</td>
      <td>统计学院</td>
      <td>统计学</td>
      <td>1</td>
      <td>湖南长沙</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2019103112</td>
      <td>王霞</td>
      <td>女</td>
      <td>信息学院</td>
      <td>大数据</td>
      <td>3</td>
      <td>广东广州</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2019103113</td>
      <td>张鹏</td>
      <td>男</td>
      <td>财金学院</td>
      <td>财政学</td>
      <td>2</td>
      <td>广西南宁</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2019103114</td>
      <td>陈杰</td>
      <td>男</td>
      <td>经济学院</td>
      <td>应用经济</td>
      <td>4</td>
      <td>海南海口</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>83.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2019103115</td>
      <td>刘佳</td>
      <td>男</td>
      <td>经济学院</td>
      <td>计量经济</td>
      <td>2</td>
      <td>四川成都</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2019103116</td>
      <td>王磊</td>
      <td>男</td>
      <td>数学学院</td>
      <td>应用数学</td>
      <td>3</td>
      <td>贵州贵阳</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2019103117</td>
      <td>杨阳</td>
      <td>男</td>
      <td>数学学院</td>
      <td>计算数学</td>
      <td>1</td>
      <td>云南昆明</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2019103118</td>
      <td>陈雪</td>
      <td>女</td>
      <td>信息学院</td>
      <td>大数据</td>
      <td>4</td>
      <td>西藏拉萨</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2019103119</td>
      <td>张健</td>
      <td>男</td>
      <td>财金学院</td>
      <td>金融</td>
      <td>2</td>
      <td>陕西西安</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2019103120</td>
      <td>王梅</td>
      <td>女</td>
      <td>经济学院</td>
      <td>应用经济</td>
      <td>3</td>
      <td>甘肃兰州</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2019103121</td>
      <td>李浩</td>
      <td>男</td>
      <td>数学学院</td>
      <td>计算数学</td>
      <td>1</td>
      <td>青海西宁</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2019103122</td>
      <td>刘欣</td>
      <td>女</td>
      <td>信息学院</td>
      <td>大数据</td>
      <td>2</td>
      <td>宁夏银川</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2019103123</td>
      <td>赵文</td>
      <td>男</td>
      <td>统计学院</td>
      <td>统计学</td>
      <td>1</td>
      <td>新疆乌鲁木齐</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2019103124</td>
      <td>杨勇</td>
      <td>男</td>
      <td>信息学院</td>
      <td>计算机</td>
      <td>3</td>
      <td>香港特别行政区</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2019103125</td>
      <td>王红</td>
      <td>女</td>
      <td>财金学院</td>
      <td>财政学</td>
      <td>4</td>
      <td>澳门特别行政区</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2019103126</td>
      <td>张婷</td>
      <td>女</td>
      <td>经济学院</td>
      <td>应用经济</td>
      <td>1</td>
      <td>台湾台北</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>34</th>
      <td>2019103127</td>
      <td>陈辉</td>
      <td>男</td>
      <td>财金学院</td>
      <td>财政学</td>
      <td>2</td>
      <td>四川成都</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2019103128</td>
      <td>李明阳</td>
      <td>男</td>
      <td>经济学院</td>
      <td>计量经济</td>
      <td>3</td>
      <td>广东广州</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>2019103129</td>
      <td>王小芳</td>
      <td>女</td>
      <td>经济学院</td>
      <td>计量经济</td>
      <td>2</td>
      <td>辽宁大连</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2019103130</td>
      <td>张鑫峰</td>
      <td>男</td>
      <td>信息学院</td>
      <td>大数据</td>
      <td>2</td>
      <td>浙江宁波</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>2019103131</td>
      <td>刘佳琪</td>
      <td>女</td>
      <td>财金学院</td>
      <td>财政学</td>
      <td>1</td>
      <td>湖南长沙</td>
      <td>CS101</td>
      <td>程序设计</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>39</th>
      <td>2019103132</td>
      <td>陈伟杰</td>
      <td>男</td>
      <td>经济学院</td>
      <td>应用经济</td>
      <td>1</td>
      <td>河北保定</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>83.0</td>
    </tr>
    <tr>
      <th>40</th>
      <td>2019103133</td>
      <td>杨晓雨</td>
      <td>女</td>
      <td>经济学院</td>
      <td>应用经济</td>
      <td>2</td>
      <td>河南许昌</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>41</th>
      <td>2019103134</td>
      <td>王宇航</td>
      <td>男</td>
      <td>数学学院</td>
      <td>计算数学</td>
      <td>3</td>
      <td>湖南衡阳</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2019103135</td>
      <td>赵梦婷</td>
      <td>女</td>
      <td>数学学院</td>
      <td>计算数学</td>
      <td>4</td>
      <td>河北沧州</td>
      <td>CS203</td>
      <td>数据结构与算法</td>
      <td>92.0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>2019103136</td>
      <td>王鹏飞</td>
      <td>男</td>
      <td>统计学院</td>
      <td>统计学</td>
      <td>4</td>
      <td>江西景德镇</td>
      <td>E202</td>
      <td>宏观经济</td>
      <td>94.0</td>
    </tr>
  </tbody>
</table>
</div><p>关于合并后的新表，列数一共10列。<code class="docutils literal notranslate"><span class="pre">student_df</span></code> 一共7列， <code class="docutils literal notranslate"><span class="pre">score_df</span></code>
一共4列，即：7 + 4 - 1，因为两个表都包含同样的一列
<code class="docutils literal notranslate"><span class="pre">sno</span></code>，所以需要减一。</p>
<p>我们使用的是 <code class="docutils literal notranslate"><span class="pre">how='left'</span></code> 的方式进行的合并。行数一共44，这与
<code class="docutils literal notranslate"><span class="pre">student_df</span></code>
的列数一致。我们打印完整合并后的新表，可以发现，在<code class="docutils literal notranslate"><span class="pre">student_df</span></code>中包含但
<code class="docutils literal notranslate"><span class="pre">score_df</span></code> 中不包含的成绩相关的信息显示 NaN。</p>
<p>接下来我们就可以使用各类其他分析方式，对这个新的大表进行数据分析，这里不再赘述。</p>
</div>
</div>


        </div>
        <div class="side-doc-outline">
            <div class="side-doc-outline--content"> 
<div class="localtoc">
    <p class="caption">
      <span class="caption-text">Table Of Contents</span>
    </p>
    <ul>
<li><a class="reference internal" href="#">3.6. 多表操作</a><ul>
<li><a class="reference internal" href="#merge">3.6.1. merge</a><ul>
<li><a class="reference internal" href="#id2">3.6.1.1. 连接方式</a></li>
<li><a class="reference internal" href="#id3">3.6.1.2. 其他合并方式</a></li>
</ul>
</li>
<li><a class="reference internal" href="#concat">3.6.2. concat</a></li>
<li><a class="reference internal" href="#id4">3.6.3. 案例：学生成绩</a></li>
</ul>
</li>
</ul>

</div>
            </div>
        </div>

      <div class="clearer"></div>
    </div><div class="pagenation">
     <a id="button-prev" href="dataframe-groupby.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="P">
         <i class="pagenation-arrow-L fas fa-arrow-left fa-lg"></i>
         <div class="pagenation-text">
            <span class="pagenation-direction">Previous</span>
            <div>3.5. 分组汇总</div>
         </div>
     </a>
     <a id="button-next" href="../refs.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="N">
         <i class="pagenation-arrow-R fas fa-arrow-right fa-lg"></i>
        <div class="pagenation-text">
            <span class="pagenation-direction">Next</span>
            <div>4. 参考文献</div>
        </div>
     </a>
  </div>
        
        </main>
    </div>
  </body>
</html>